<?xml version="1.0" encoding="utf-8"?>
<RibbonDiffXml xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <CustomActions>
    <HideCustomAction HideActionId="dia.adx.contact.Form.ChangePassword.Button.Hide" Location="adx.contact.Form.ChangePassword.Button" />
    <HideCustomAction HideActionId="dia.adx.contact.form.CreateInvitation.Button.Hide" Location="adx.contact.form.CreateInvitation.Button" />
    <HideCustomAction HideActionId="dia.Mscrm.Form.contact.Permissions.Sharing.Hide" Location="Mscrm.Form.contact.Permissions.Sharing" />
    <HideCustomAction HideActionId="dia.Mscrm.HomepageGrid.contact.MBPF.ConvertTo.Hide" Location="Mscrm.HomepageGrid.contact.MBPF.ConvertTo" />
    <CustomAction Id="diap.Mscrm.Form.contact.Permissions.Sharing.CustomAction" Location="Mscrm.Form.contact.MainTab.Collaborate.Controls._children" Sequence="40">
      <CommandUIDefinition>
        <Button Alt="$Resources:Ribbon.HomepageGrid.MainTab.Actions.Sharing" Command="Mscrm.SharePrimaryRecordRefresh" Id="Mscrm.Form.contact.Permissions.Sharing" Image32by32="/_imgs/ribbon/Sharing_32.png" Image16by16="/_imgs/ribbon/Sharing_16.png" LabelText="$Resources:Ribbon.HomepageGrid.MainTab.Actions.Sharing" Sequence="40" TemplateAlias="o1" ToolTipTitle="$Resources:Ribbon.HomepageGrid.MainTab.Actions.Sharing" ToolTipDescription="$Resources(EntityPluralDisplayName):Ribbon.Tooltip.Share" ModernImage="Share" />
      </CommandUIDefinition>
    </CustomAction>
    <CustomAction Id="diap.Mscrm.HomepageGrid.contact.MBPF.ConvertTo.CustomAction" Location="Mscrm.Form.contact.MainTab.Actions.Controls._children" Sequence="62">
      <CommandUIDefinition>
        <FlyoutAnchor Alt="$LocLabels:Mscrm.HomepageGrid.contact.MBPF.ConvertTo.Alt" Command="Mscrm.Form.Process" Id="Mscrm.HomepageGrid.contact.MBPF.ConvertTo" Image16by16="/_imgs/Workplace/ConvertActivity_16.png" Image32by32="/_imgs/Workplace/ConvertActivity_32.png" LabelText="$LocLabels:Mscrm.HomepageGrid.contact.MBPF.ConvertTo.LabelText" Sequence="62" TemplateAlias="o1" ToolTipTitle="$LocLabels:Mscrm.HomepageGrid.contact.MBPF.ConvertTo.ToolTipTitle" ToolTipDescription="$LocLabels:Mscrm.HomepageGrid.contact.MBPF.ConvertTo.ToolTipDescription" ModernImage="Process">
          <Menu Id="Mscrm.HomepageGrid.contact.MBPF.ConvertTo.Menu">
            <MenuSection Id="Mscrm.HomepageGrid.contact.MBPF.MenuSection" Sequence="63" DisplayMode="Menu16">
              <Controls Id="Mscrm.HomepageGrid.contact.MBPF.MenuSection.Controls">
                <Button Alt="$Resources:RefreshCommandBar.SwitchProcess" Command="Mscrm.SwitchProcess" Id="Mscrm.Form.contact.SwitchProcess" Image32by32="/_imgs/ribbon/convert_32.png" Image16by16="/_imgs/ribbon/convert_16.png" LabelText="$Resources:RefreshCommandBar.SwitchProcess" Sequence="10" TemplateAlias="o1" ToolTipTitle="$Resources:RefreshCommandBar.SwitchProcess" ToolTipDescription="$Resources:Ribbon.Tooltip.SwitchProcess" ModernImage="SwitchProcess" />
                <Button Alt="$Resources:RefreshCommandBar.EditSalesProcess" Command="Mscrm.EditSalesProcess" Id="Mscrm.Form.contact.EditSalesProcess" Image32by32="/_imgs/ribbon/edit32.png" Image16by16="/_imgs/ribbon/edit_16.png" LabelText="$Resources:RefreshCommandBar.EditSalesProcess" Sequence="20" TemplateAlias="o1" ToolTipTitle="$Resources:RefreshCommandBar.EditSalesProcess" ToolTipDescription="$Resources:Ribbon.Tooltip.EditSalesProcess" />
                <Button Alt="$Resources:RefreshCommandBar.Abandon" Command="Mscrm.Abandon" Id="Mscrm.Form.contact.Abandon" Image32by32="/_imgs/ribbon/convert_32.png" Image16by16="/_imgs/ribbon/convert_16.png" LabelText="$Resources:RefreshCommandBar.Abandon" Sequence="30" TemplateAlias="o1" ToolTipTitle="$Resources:RefreshCommandBar.Abandon" ToolTipDescription="$Resources:Ribbon.Tooltip.Abandon" ModernImage="Abandon" />
                <Button Alt="$Resources:RefreshCommandBar.Reactivate" Command="Mscrm.Reactivate" Id="Mscrm.Form.contact.Reactivate" Image32by32="/_imgs/ribbon/convert_32.png" Image16by16="/_imgs/ribbon/convert_16.png" LabelText="$Resources:RefreshCommandBar.Reactivate" Sequence="40" TemplateAlias="o1" ToolTipTitle="$Resources:RefreshCommandBar.Reactivate" ToolTipDescription="$Resources:Ribbon.Tooltip.Reactivate" ModernImage="Reactivate" />
                <Button Alt="$Resources:RefreshCommandBar.FinishStage" Command="Mscrm.FinishStage" Id="Mscrm.Form.contact.FinishStage" Image32by32="/_imgs/ribbon/convert_32.png" Image16by16="/_imgs/ribbon/convert_16.png" LabelText="$Resources:RefreshCommandBar.FinishStage" Sequence="50" TemplateAlias="o1" ToolTipTitle="$Resources:RefreshCommandBar.FinishStage" ToolTipDescription="$Resources:Ribbon.Tooltip.FinishStage" ModernImage="FinishStage" />
              </Controls>
            </MenuSection>
          </Menu>
        </FlyoutAnchor>
      </CommandUIDefinition>
    </CustomAction>
  </CustomActions>
  <Templates>
    <RibbonTemplates Id="Mscrm.Templates"></RibbonTemplates>
  </Templates>
  <CommandDefinitions>
    <CommandDefinition Id="Mscrm.Form.Process">
      <EnableRules>
        <EnableRule Id="Mscrm.FormStateNotNew" />
        <EnableRule Id="Mscrm.Disabled" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="Mscrm.CanWritePrimary" />
        <DisplayRule Id="Mscrm.IsBusinessProcessEnabled" />
      </DisplayRules>
      <Actions />
    </CommandDefinition>
    <CommandDefinition Id="Mscrm.SharePrimaryRecordRefresh">
      <EnableRules>
        <EnableRule Id="Mscrm.FormStateNotNew" />
        <EnableRule Id="Mscrm.SharePrimaryPermission" />
        <EnableRule Id="Mscrm.NotOffline" />
        <EnableRule Id="Mscrm.ShowOnNonModernAndModernIfAllowed" />
        <EnableRule Id="Mscrm.Disabled" />
      </EnableRules>
      <DisplayRules>
        <DisplayRule Id="Mscrm.SharePrimaryPermission" />
        <DisplayRule Id="Mscrm.HybridDialogShareEnabled" />
        <DisplayRule Id="Mscrm.HideInLegacyRibbon" />
        <DisplayRule Id="Mscrm.OutlookRenderTypeWeb" />
      </DisplayRules>
      <Actions>
        <JavaScriptFunction FunctionName="XrmCore.Commands.Common.onActionMenuClick" Library="$webresource:Main_system_library.js">
          <StringParameter Value="share" />
          <CrmParameter Value="PrimaryEntityTypeName" />
        </JavaScriptFunction>
      </Actions>
    </CommandDefinition>
  </CommandDefinitions>
  <RuleDefinitions>
    <TabDisplayRules />
    <DisplayRules>
      <DisplayRule Id="Mscrm.CanWritePrimary">
        <EntityPrivilegeRule PrivilegeType="Write" PrivilegeDepth="Basic" AppliesTo="PrimaryEntity" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.HideInLegacyRibbon">
        <CommandClientTypeRule Type="Legacy" InvertResult="true" />
        <PageRule Address="/userdefined/edit.aspx" InvertResult="true" />
        <PageRule Address="/advancedfind/advfind.aspx" InvertResult="true" />
        <PageRule Address="/advancedfind/fetchData.aspx" InvertResult="true" />
        <PageRule Address="/tools/formeditor/formeditor.aspx" InvertResult="true" />
        <PageRule Address="/tools/visualizationdesigner/visualizationdesigner.aspx" InvertResult="true" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.HybridDialogShareEnabled">
        <OrRule>
          <Or>
            <CommandClientTypeRule Type="Modern" InvertResult="true" />
          </Or>
          <Or>
            <EntityRule />
          </Or>
        </OrRule>
      </DisplayRule>
      <DisplayRule Id="Mscrm.IsBusinessProcessEnabled">
        <EntityPropertyRule AppliesTo="PrimaryEntity" PropertyName="IsBusinessProcessEnabled" PropertyValue="true" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.OutlookRenderTypeWeb">
        <OutlookRenderTypeRule Type="Web" />
      </DisplayRule>
      <DisplayRule Id="Mscrm.SharePrimaryPermission">
        <EntityPrivilegeRule PrivilegeType="Share" PrivilegeDepth="Basic" AppliesTo="PrimaryEntity" />
        <FormEntityContextRule EntityName="bulkoperation" InvertResult="true" />
      </DisplayRule>
    </DisplayRules>
    <EnableRules>
      <EnableRule Id="Mscrm.FormStateNotNew">
        <FormStateRule State="Create" InvertResult="true" />
      </EnableRule>
      <EnableRule Id="Mscrm.NotOffline">
        <CrmOfflineAccessStateRule State="Offline" InvertResult="true" />
      </EnableRule>
      <EnableRule Id="Mscrm.SharePrimaryPermission">
        <RecordPrivilegeRule PrivilegeType="Share" AppliesTo="PrimaryEntity" />
      </EnableRule>
      <EnableRule Id="Mscrm.ShowOnNonModernAndModernIfAllowed">
        <OrRule>
          <Or>
            <CommandClientTypeRule Type="Modern" InvertResult="true" />
          </Or>
          <Or>
            <CustomRule FunctionName="XrmCore.InternalUtilities.DialogUtilities.isAllowLegacyDialogsEmbedding" Library="$webresource:Main_system_library.js" />
          </Or>
        </OrRule>
      </EnableRule>
    </EnableRules>
  </RuleDefinitions>
  <LocLabels>
    <LocLabel Id="Mscrm.HomepageGrid.contact.MBPF.ConvertTo.Alt">
      <Titles>
        <Title description="Process" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="Mscrm.HomepageGrid.contact.MBPF.ConvertTo.LabelText">
      <Titles>
        <Title description="Process" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="Mscrm.HomepageGrid.contact.MBPF.ConvertTo.ToolTipDescription">
      <Titles>
        <Title description="Process" languagecode="1033" />
      </Titles>
    </LocLabel>
    <LocLabel Id="Mscrm.HomepageGrid.contact.MBPF.ConvertTo.ToolTipTitle">
      <Titles>
        <Title description="Process" languagecode="1033" />
      </Titles>
    </LocLabel>
  </LocLabels>
</RibbonDiffXml>